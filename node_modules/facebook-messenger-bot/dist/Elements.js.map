{"version":3,"sources":["../src/Elements.js"],"names":[],"mappings":"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","file":"Elements.js","sourcesContent":["import Buttons from './Buttons';\nimport QuickReplies from './QuickReplies';\n\nclass Elements {\n  constructor() {\n    this._elements = [];\n    this._quickreplies = null;\n  }\n\n  add({text, image, subtext, buttons}) {\n    if (buttons) {\n      if (!(buttons instanceof Buttons)) {\n        if (Array.isArray(buttons)) {\n          buttons = Buttons.from(buttons);\n        } else {\n          throw Error('Unable to parse buttons');\n        }\n      }\n    }\n\n    this._elements.push({text, image, subtext, buttons});\n    return this;\n  }\n\n  setQuickReplies(quickreplies) {\n    if (quickreplies) {\n      if (!(quickreplies instanceof QuickReplies)) {\n        if (Array.isArray(quickreplies)) {\n          quickreplies = QuickReplies.from(quickreplies);\n        } else {\n          throw Error('Unable to parse quickreplies');\n        }\n      }\n    }\n\n    this._quickreplies = quickreplies;\n  }\n\n  getQuickReplies() {\n    return this._quickreplies;\n  }\n\n  get length() {\n    return this._elements.length;\n  }\n\n  toJSON() {\n    const build = () => {\n      if (this._elements.length > 1) {\n        const elements = [];\n        for (const e of this._elements) {\n          const element = {};\n          if (e.text) element.title = e.text;\n          if (e.image) element.image_url = e.image;\n          if (e.subtext) element.subtitle = e.subtext;\n          if (e.buttons && e.buttons.length) element.buttons = e.buttons.toJSON();\n          elements.push(element);\n        }\n        return {attachment: {type: 'template', payload: {template_type: 'generic', elements}}};\n      } else if (this._elements.length === 1) {\n        const e = this._elements[0];\n        const element = {};\n        if (e.text && e.buttons && e.buttons.length && e.image) {\n          element.title = e.text;\n          element.image_url = e.image;\n          if (e.subtext) element.subtitle = e.subtext;\n          element.buttons = e.buttons.toJSON();\n          return {attachment: {type: 'template', payload: {template_type: 'generic', elements: [element]}}};\n        } else if (e.text && e.buttons && e.buttons.length) {\n          element.text = e.text;\n          if (e.image) element.image_url = e.image;\n          element.buttons = e.buttons.toJSON();\n          return {attachment: {type: 'template', payload: {template_type: 'button', ...element}}};\n        } else if (e.text) {\n          return {text: e.text};\n        } else if (e.image) {\n          return {attachment: {type: 'image', payload: {url: e.image}}};\n        }\n      }\n\n      throw Error('Could not form a message. Have you followed the format?');\n    };\n\n    const built = build();\n\n    if (this._quickreplies && this._quickreplies.length) {\n      built.quick_replies = this._quickreplies.toJSON();\n    }\n\n    return built;\n  }\n}\n\nexport default Elements;\n"]}